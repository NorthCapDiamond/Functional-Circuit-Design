#include <stdint.h>
#include <stdio.h>
#include <math.h>


uint8_t crc_my(uint8_t sum, uint8_t in){
	uint8_t shift = sum;
	for(uint8_t i = 0; i < 8; i++){
		shift ^= in;
		if(shift & 0b10000000){
			shift = (shift << 1);
			shift ^= 0b01110001;
		}else{
			shift = (shift << 1);
		}
	}
	return shift;
}



int main(void){


	uint8_t lfsra[255] = {34,68,137,18,37,75,150,44,88,176,96,193,131,6,12,24,49,98,197,139,22,45,91,183,111,222,189,123,247,238,220,185,115,231,207,159,63,126,252,249,242,229,203,151,47,95,191,127,255,254,253,250,245,234,212,169,82,164,73,146,36,72,145,35,71,142,29,58,117,235,215,174,93,187,119,239,223,190,124,248,241,226,196,136,17,34,68,137,18,37,75,150,44,88,176,96,193,131,6,12,24,49,98,197,139,22,45,91,183,111,222,189,123,247,238,220,185,115,231,207,159,63,126,252,249,242,229,203,151,47,95,191,127,255,254,253,250,245,234,212,169,82,164,73,146,36,72,145,35,71,142,29,58,117,235,215,174,93,187,119,239,223,190,124,248,241,226,196,136,17,34,68,137,18,37,75,150,44,88,176,96,193,131,6,12,24,49,98,197,139,22,45,91,183,111,222,189,123,247,238,220,185,115,231,207,159,63,126,252,249,242,229,203,151,47,95,191,127,255,254,253,250,245,234,212,169,82,164,73,146,36,72,145,35,71,142,29,58,117,235,215,174,93,187,119,239,223,190,124,248,241,226,196,136,17};
	uint8_t lfsrb[255] = {35,70,140,25,51,102,204,152,49,99,199,142,28,56,112,225,195,134,12,24,48,96,193,131,7,14,29,59,118,236,216,176,97,194,133,10,21,43,86,172,89,178,100,201,147,39,78,156,57,115,231,206,157,58,117,234,213,171,87,175,95,191,127,255,254,253,251,246,237,219,182,108,217,179,103,207,158,60,120,241,227,198,141,26,53,107,215,174,92,185,114,228,200,144,33,67,135,15,30,61,123,247,238,221,187,119,239,222,189,122,244,232,208,160,65,130,4,8,16,32,64,129,2,5,11,22,45,91,183,111,223,190,124,249,243,230,205,155,55,110,220,184,113,226,197,139,23,46,93,186,116,233,211,166,76,153,50,101,202,149,42,85,170,84,169,82,164,73,146,36,72,145,34,69,138,20,40,80,161,66,132,9,19,38,77,154,52,104,209,163,71,143,31,62,125,250,245,235,214,173,90,180,105,210,165,74,148,41,83,167,79,159,63,126,252,248,240,224,192,128,1,3,6,13,27,54,109,218,181,106,212,168,81,162,68,137,18,37,75,151,47,94,188,121,242,229,203,150,44,88,177,98,196,136,17};
	
	printf("{");
	for(uint64_t i = 0; i < 255; i++){
		printf("%#02x, ", 3*lfsra[i] + 2 * ((uint8_t)cbrt((double)lfsrb[i])));
	}
	printf("}\n");

	uint16_t testarr[256] = {0, 0x6c, 0xd4, 0x1a5, 0x3a, 0x75, 0xe9, 0x1cc, 0x8e, 0x10e, 0x218, 0x12a, 0x24d, 0x18f, 0x18, 0x2c, 0x54, 0x9d, 0x130, 0x253, 0x1a5, 0x48, 0x8f, 0x11b, 0x22f, 0x14f, 0x29e, 0x23d, 0x177, 0x2ed, 0x2d6, 0x2a0, 0x235, 0x161, 0x2bf, 0x277, 0x1e1, 0xc1, 0x180, 0x2fc, 0x2f5, 0x2de, 0x2b9, 0x269, 0x1cf, 0x97, 0x123, 0x245, 0x187, 0x303, 0x302, 0x303, 0x2f8, 0x2e9, 0x2c4, 0x284, 0x207, 0x100, 0x1f6, 0xe3, 0x1c0, 0x74, 0xe2, 0x1bd, 0x75, 0xe1, 0x1b6, 0x63, 0xba, 0x16b, 0x2cd, 0x28f, 0x212, 0x123, 0x23b, 0x16d, 0x2d7, 0x2a7, 0x240, 0x17c, 0x2f4, 0x2df, 0x2b0, 0x256, 0x19c, 0x39, 0x6e, 0xd6, 0x1a5, 0x3e, 0x79, 0xe9, 0x1ce, 0x8e, 0x112, 0x216, 0x128, 0x24d, 0x18d, 0x18, 0x2a, 0x50, 0x9f, 0x132, 0x25b, 0x1ab, 0x4a, 0x93, 0x11d, 0x22f, 0x155, 0x2a6, 0x243, 0x17b, 0x2ef, 0x2d2, 0x29e, 0x22d, 0x15d, 0x2b9, 0x273, 0x1e5, 0xc7, 0x17c, 0x2f6, 0x2ef, 0x2da, 0x2b5, 0x269, 0x1cf, 0x95, 0x129, 0x247, 0x185, 0x309, 0x306, 0x303, 0x2f8, 0x2e9, 0x2c4, 0x284, 0x207, 0x100, 0x1f4, 0xe7, 0x1c0, 0x76, 0xdc, 0x1b9, 0x71, 0xdf, 0x1b2, 0x63, 0xb8, 0x169, 0x2c9, 0x28f, 0x210, 0x11f, 0x23b, 0x16f, 0x2d3, 0x2a5, 0x244, 0x17c, 0x2f2, 0x2db, 0x2b0, 0x254, 0x1a2, 0x39, 0x6e, 0xd6, 0x1a1, 0x3e, 0x79, 0xe5, 0x1c8, 0x8c, 0x112, 0x218, 0x12a, 0x247, 0x18d, 0x18, 0x2c, 0x52, 0x99, 0x12e, 0x259, 0x1ab, 0x4a, 0x91, 0x117, 0x22b, 0x157, 0x2a6, 0x243, 0x17d, 0x2ef, 0x2d4, 0x29c, 0x235, 0x161, 0x2bf, 0x277, 0x1e5, 0xc7, 0x180, 0x2fc, 0x2f5, 0x2de, 0x2b9, 0x267, 0x1cf, 0x99, 0x129, 0x249, 0x189, 0x307, 0x304, 0x2f9, 0x2f0, 0x2e1, 0x2c2, 0x282, 0x201, 0xfe, 0x1f8, 0xe5, 0x1be, 0x76, 0xe2, 0x1bb, 0x73, 0xdd, 0x1b4, 0x5b, 0xb4, 0x167, 0x2cb, 0x28b, 0x212, 0x121, 0x239, 0x171, 0x2d9, 0x2a7, 0x244, 0x17a, 0x2f0, 0x2dd, 0x2ae, 0x256, 0x1a2, 0x37};
	uint8_t crcval = 0xB8;
	for(uint64_t i = 0; i < 256; i++){		
		crcval = crc_my(crcval, (uint8_t)testarr[i]);
		crcval = crc_my(crcval, *((uint8_t*)(testarr+i)+1) );
		printf("%d\n", crcval);
	}
	
	
	uint8_t arr_verilog[256] = {184,193,230,185,103,44,117,151,221,161,34,217,87,83,204,134,142,231,23,207,89,33,72,148,251,165,230,254,125,185,38,3,78,196,156,131,100,32,79,240,94,96,57,183,253,175,210,183,211,98,44,146,103,99,61,160,176,6,71,181,132,17,140,34,227,172,77,251,8,73,169,160,3,127,215,192,102,203,186,94,116,175,28,59,210,223,152,27,105,54,133,239,219,129,121,149,177,78,19,113,235,88,29,252,218,62,24,155,249,45,60,124,2,234,66,62,211,69,37,250,143,230,188,33,210,156,25,52,0,185,196,175,201,15,91,57,80,172,229,157,210,4,38,93,24,135,117,116,141,119,245,99,244,141,4,6,52,57,200,64,158,160,60,67,59,246,186,222,240,221,0,76,21,31,190,83,118,86,17,149,50,212,69,134,184,250,76,198,157,95,115,62,73,182,211,98,186,150,208,150,48,79,72,12,126,82,198,166,5,237,65,232,239,46,249,240,66,157,69,227,212,141,240,251,32,85,189,254,206,188,35,101,121,197,116,24,190,93,2,76,160,7,41,76,45,43,162,228,37,221,146,66,193,169,32};
	uint8_t arr_test[257] = {184, 193,230,185,103,44,117,151,221,161,34,217,87,83,204,134,142,231,23,207,89,33,72,148,251,165,230,254,125,185,38,3,78,196,156,131,100,32,79,240,94,96,57,183,253,175,210,183,211,98,44,146,103,99,61,160,176,6,71,181,132,17,140,34,227,172,77,251,8,73,169,160,3,127,215,192,102,203,186,94,116,175,28,59,210,223,152,27,105,54,133,239,219,129,121,149,177,78,19,113,235,88,29,252,218,62,24,155,249,45,60,124,2,234,66,62,211,69,37,250,143,230,188,33,210,156,25,52,0,185,196,175,201,15,91,57,80,172,229,157,210,4,38,93,24,135,117,116,141,119,245,99,244,141,4,6,52,57,200,64,158,160,60,67,59,246,186,222,240,221,0,76,21,31,190,83,118,86,17,149,50,212,69,134,184,250,76,198,157,95,115,62,73,182,211,98,186,150,208,150,48,79,72,12,126,82,198,166,5,237,65,232,239,46,249,240,66,157,69,227,212,141,240,251,32,85,189,254,206,188,35,101,121,197,116,24,190,93,2,76,160,7,41,76,45,43,162,228,37,221,146,66,193,169,32,89,20};

	for(uint64_t i = 0; i < 255; i++){
		if(arr_test[i] == arr_verilog[i]){
			printf("%ld - OK, v:%#02x, t:%#02x\n", i, arr_verilog[i], arr_test[i]);
		}else{
			printf("!!! %ld - FAIL, v:%#02x, t:%#02x\n", i, arr_verilog[i], arr_test[i]);
		}
	}
}
